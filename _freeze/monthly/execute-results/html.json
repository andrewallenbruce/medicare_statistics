{
  "hash": "ddbd86b6d04220224b1ce8ff8aa6d091",
  "result": {
    "markdown": "---\ntitle: \"Medicare Enrollment\"\nsubtitle: \"Total, Deaths, & New Enrollments, 2008 - 2021\"\nauthor: \"Andrew Bruce\"\nformat: \n  html:\n    theme: zephyr\n    toc: true\n    number-sections: false\ndate: last-modified\ncode-fold: true\ncode-overflow: scroll\n---\n\n::: {.cell}\n\n:::\n\n\n\n# Enrollment\n\nBeneficiary Enrollment by Year, 2008-2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenrollment <- enroll_1 |> \n  dplyr::mutate(group = \"Enrollment\", \n                .after = year)\nenrollment |> \n  dplyr::select(year, group, dplyr::contains(\"pct_chg\")) |> \n  dplyr::filter(year != 2008L) |> \n  dplyr::mutate(year = as_date(parsedate::parse_date(year))) |> \n  ggplot2::ggplot(aes(x = year)) +\n  geom_line(aes(y = total_pct_chg), linewidth = 0.5, linetype = 2, color = thematic::okabe_ito(3)[1]) + \n  geom_line(aes(y = original_pct_chg), linewidth = 0.5, linetype = 1, color = thematic::okabe_ito(3)[3]) + \n  geom_line(aes(y = ma_other_pct_chg), linewidth = 0.5, linetype = 1, color = thematic::okabe_ito(3)[2]) +\n  scale_y_continuous(labels = scales::percent) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight()\n```\n\n::: {.cell-output-display}\n![](monthly_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n<br>\n\n# Deaths\n\nBeneficiary Deaths by Month, 2008-2021\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\ndeaths <- enroll_33 |> \n  dplyr::mutate(group = \"Deaths\", \n                .after = year)\ndeaths\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 53\n    year group    total total_chg total_pct_chg january january_pct january_chg\n   <int> <chr>    <dbl>     <dbl>         <dbl>   <dbl>       <dbl>       <dbl>\n 1  2008 Deaths 1998215        NA     NA         183291      0.0917          NA\n 2  2009 Deaths 1964086    -34129     -0.0171    181710      0.0925       -1581\n 3  2010 Deaths 2003962     39876      0.0203    182764      0.0912        1054\n 4  2011 Deaths 2046334     42372      0.0211    192388      0.0940        9624\n 5  2012 Deaths 2077591     31257      0.0153    185736      0.0894       -6652\n 6  2013 Deaths 2126488     48897      0.0235    218498      0.103        32762\n 7  2014 Deaths 2144287     17799      0.00837   199003      0.0928      -19495\n 8  2015 Deaths 2220438     76151      0.0355    222132      0.100        23129\n 9  2016 Deaths 2226692      6254      0.00282   203187      0.0913      -18945\n10  2017 Deaths 2290129     63437      0.0285    217850      0.0951       14663\n11  2018 Deaths 2323160     33031      0.0144    239498      0.103        21648\n12  2019 Deaths 2337988     14828      0.00638   213519      0.0913      -25979\n13  2020 Deaths 2750553    412565      0.176     218061      0.0793        4542\n14  2021 Deaths 2750141      -412     -0.000150  307319      0.112        89258\n# ℹ 45 more variables: january_pct_chg <dbl>, february <dbl>,\n#   february_pct <dbl>, february_chg <dbl>, february_pct_chg <dbl>,\n#   march <dbl>, march_pct <dbl>, march_chg <dbl>, march_pct_chg <dbl>,\n#   april <dbl>, april_pct <dbl>, april_chg <dbl>, april_pct_chg <dbl>,\n#   may <dbl>, may_pct <dbl>, may_chg <dbl>, may_pct_chg <dbl>, june <dbl>,\n#   june_pct <dbl>, june_chg <dbl>, june_pct_chg <dbl>, july <dbl>,\n#   july_pct <dbl>, july_chg <dbl>, july_pct_chg <dbl>, august <dbl>, …\n```\n:::\n:::\n\n\n\n# New Enrollees\n\nNew Enrollees by Month, 2008-2021\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\nnew_enroll <- enroll_22 |> \n  dplyr::mutate(group = \"New Enrollees\", \n                .after = year)\nnew_enroll\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 53\n    year group     total total_chg total_pct_chg january january_pct january_chg\n   <int> <chr>     <dbl>     <dbl>         <dbl>   <dbl>       <dbl>       <dbl>\n 1  2008 New Enr… 3.10e6        NA     NA         266382      0.0859          NA\n 2  2009 New Enr… 3.07e6    -31775     -0.0102    256252      0.0835      -10130\n 3  2010 New Enr… 3.11e6     44920      0.0146    258884      0.0831        2632\n 4  2011 New Enr… 3.63e6    516512      0.166     259195      0.0714         311\n 5  2012 New Enr… 3.93e6    303169      0.0835    345565      0.0878       86370\n 6  2013 New Enr… 3.76e6   -170444     -0.0433    314155      0.0835      -31410\n 7  2014 New Enr… 3.72e6    -45536     -0.0121    308207      0.0829       -5948\n 8  2015 New Enr… 3.68e6    -33150     -0.00892   307784      0.0835        -423\n 9  2016 New Enr… 3.68e6     -1028     -0.000279  302641      0.0822       -5143\n10  2017 New Enr… 3.79e6    110027      0.0299    308881      0.0814        6240\n11  2018 New Enr… 3.77e6    -23633     -0.00623   315487      0.0837        6606\n12  2019 New Enr… 3.84e6     74288      0.0197    319276      0.0830        3789\n13  2020 New Enr… 3.79e6    -51005     -0.0133    316713      0.0835       -2563\n14  2021 New Enr… 3.83e6     38745      0.0102    318412      0.0831        1699\n# ℹ 45 more variables: january_pct_chg <dbl>, february <dbl>,\n#   february_pct <dbl>, february_chg <dbl>, february_pct_chg <dbl>,\n#   march <dbl>, march_pct <dbl>, march_chg <dbl>, march_pct_chg <dbl>,\n#   april <dbl>, april_pct <dbl>, april_chg <dbl>, april_pct_chg <dbl>,\n#   may <dbl>, may_pct <dbl>, may_chg <dbl>, may_pct_chg <dbl>, june <dbl>,\n#   june_pct <dbl>, june_chg <dbl>, june_pct_chg <dbl>, july <dbl>,\n#   july_pct <dbl>, july_chg <dbl>, july_pct_chg <dbl>, august <dbl>, …\n```\n:::\n:::\n\n\n<br>\n\n# Percentages of Total Enrollees\n\n## New Enrollees vs. Beneficiary Deaths\n\n\n::: {.cell layout-ncol=\"1\" fig.showtext='true'}\n\n```{.r .cell-code}\ndth_new_pct <- dplyr::bind_rows(\n  enrollment[1:3], \n  deaths[1:3], \n  new_enroll[1:3]) |> \n  tidyr::pivot_wider(\n    names_from = group, \n    values_from = total) |> \n  janitor::clean_names() |> \n  dplyr::mutate(pct_death = deaths / enrollment,\n                pct_new = new_enrollees / enrollment,\n                year = as_date(parsedate::parse_date(year))) |> \n  dplyr::select(year, \n                Deaths = pct_death, \n                \"New Enrollees\" = pct_new) |> \n  tidyr::pivot_longer(!year, \n                      names_to = \"type\", \n                      values_to = \"pct\")\n\ndth_ends <- dth_new_pct |> \n  dplyr::arrange(dplyr::desc(year)) |> \n  dplyr::slice_head(n = 2) |> \n  dplyr::pull(pct)\n\ndth_new_pct |>  \n  ggplot2::ggplot(aes(x = year, y = pct, color = type)) +\n  geom_line(linewidth = 0.5, linetype = 1) +\n  scale_y_continuous(\n    labels = scales::percent, \n    sec.axis = ggplot2::sec_axis(~ ., breaks = dth_ends)) +\n  gghighlight::gghighlight(pct > 0, \n                           label_key = type, \n                           line_label_type = \"sec_axis\",\n                           use_group_by = FALSE) +\n  scale_color_manual(name = \"\", \n                     values = c(\"red\",\"steelblue\")) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Percentages of Total Enrollees](monthly_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndth_new_pct |>  \n  ggplot2::ggplot(aes(x = year, y = pct, color = type)) +\n  geom_line(linewidth = 0.5, linetype = 2) +\n  scale_y_continuous(\n    labels = scales::percent, \n    sec.axis = ggplot2::sec_axis(~ ., breaks = dth_ends)) +\n  gghighlight::gghighlight(pct > 0, \n                           label_key = type, \n                           line_label_type = \"sec_axis\",\n                           use_group_by = FALSE) +\n  scale_color_manual(name = \"\", \n                     values = c(\"red\",\"steelblue\")) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  geom_smooth(method = lm, se = TRUE) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Linear Regression](monthly_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\ndth_new_pct |>  \n  ggplot2::ggplot(aes(x = year, y = pct, color = type)) +\n  geom_line(linewidth = 0.5, linetype = 2) +\n  scale_y_continuous(\n    labels = scales::percent, \n    sec.axis = ggplot2::sec_axis(~ ., breaks = dth_ends)) +\n  gghighlight::gghighlight(pct > 0, \n                           label_key = type, \n                           line_label_type = \"sec_axis\",\n                           use_group_by = FALSE) +\n  scale_color_manual(name = \"\", \n                     values = c(\"red\",\"steelblue\")) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  geom_smooth(span = 0.8) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Loess Regression](monthly_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\n<br>\n\n# Original Medicare vs. Medicare Advantage\n\n\n::: {.cell layout-ncol=\"1\" fig.showtext='true'}\n\n```{.r .cell-code}\norig_ma_pct <- enrollment |> \n  dplyr::select(year, \n                \"Original Medicare\" = original_pct, \n                \"Medicare Advantage\" = ma_other_pct) |> \n  dplyr::mutate(year = as_date(parsedate::parse_date(year))) |> \n  tidyr::pivot_longer(!year, \n                      names_to = \"type\", \n                      values_to = \"pct\")\n\norigma_ends <- orig_ma_pct |> \n  dplyr::arrange(dplyr::desc(year)) |> \n  dplyr::slice_head(n = 2) |> \n  dplyr::pull(pct)\n\norig_ma_pct |>  \n  ggplot2::ggplot(aes(x = year, y = pct, color = type)) +\n  geom_line(linewidth = 0.5, linetype = 1) +\n  scale_y_continuous(\n    labels = scales::percent, \n    sec.axis = ggplot2::sec_axis(~ ., breaks = origma_ends)) +\n  gghighlight::gghighlight(pct > 0, \n                           label_key = type, \n                           line_label_type = \"sec_axis\",\n                           use_group_by = FALSE) +\n  scale_color_manual(name = \"\", \n                     values = c(\"red\",\"steelblue\")) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Percentages of Total Enrollees](monthly_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\norig_ma_pct |>  \n  ggplot2::ggplot(aes(x = year, y = pct, color = type)) +\n  geom_line(linewidth = 0.5, linetype = 2) +\n  scale_y_continuous(\n    labels = scales::percent, \n    sec.axis = ggplot2::sec_axis(~ ., breaks = origma_ends)) +\n  gghighlight::gghighlight(pct > 0, \n                           label_key = type, \n                           line_label_type = \"sec_axis\",\n                           use_group_by = FALSE) +\n  scale_color_manual(name = \"\", \n                     values = c(\"red\",\"steelblue\")) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  geom_smooth(method = lm, se = TRUE) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Linear Regression](monthly_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n<br>\n\n\n::: {.cell layout-ncol=\"1\" fig.showtext='true'}\n\n```{.r .cell-code}\norig_ma_res_pct <- enroll_2 |> \n  dplyr::select(year,\n                residence = area_of_residence,\n                \"Original Medicare\" = original_pct,\n                \"Medicare Advantage\" = ma_other_pct) |> \n  tidyr::pivot_longer(cols = dplyr::contains(\"Medicare\"), \n                      names_to = \"type\", \n                      values_to = \"pct\") |> \n  dplyr::mutate(year = as_date(parsedate::parse_date(year)))\n\navg <- orig_ma_res_pct |> \n  dplyr::filter(residence != \"United States\") |> \n  dplyr::group_by(year, type) |> \n  dplyr::summarise(pct = mean(pct), \n                   .groups = \"drop\") |> \n  dplyr::mutate(residence = \"Average\", \n                .after = year)\n\norig_ma_res_pct <- dplyr::bind_rows(orig_ma_res_pct, avg)\n\norig_res_ends <- orig_ma_res_pct |> \n  dplyr::filter(residence == \"United States\") |> \n  dplyr::arrange(dplyr::desc(year)) |> \n  dplyr::slice_head(n = 2) |> \n  dplyr::filter(type == \"Original Medicare\") |> \n  dplyr::pull(pct)\n\norig_ma_res_pct |>  \n  dplyr::filter(type == \"Original Medicare\") |> \n  ggplot2::ggplot(aes(x = year, y = pct, color = residence)) +\n  geom_line(linewidth = 1.5, linetype = 1) +\n  gghighlight::gghighlight(residence %in% c(\"United States\", \n                                            #\"Alaska\", \n                                            #\"Minnesota\", \n                                            \"Average\"), \n                           label_key = residence,\n                           use_direct_label = TRUE,\n                           use_group_by = FALSE,\n                           unhighlighted_params = list(linewidth = 0.5)\n                           ) +\n  geom_hline(yintercept = 0.5, linewidth = 1, linetype = 2, col = \"grey40\") +\n  scale_y_continuous(labels = scales::percent) +\n  scale_color_manual(name = \"\",\n                     values = thematic::okabe_ito(4)) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         title = \"Original Medicare Enrollees (%)\",\n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Percentages of Total Enrollees](monthly_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\norig_ma_res_pct |>  \n  dplyr::filter(type == \"Medicare Advantage\") |> \n  ggplot2::ggplot(aes(x = year, y = pct, color = residence)) +\n  geom_line(linewidth = 1.5, linetype = 1) +\n  gghighlight::gghighlight(residence %in% c(\"United States\", \n                                            #\"Alaska\", \n                                            #\"Minnesota\", \n                                            \"Average\"), \n                           label_key = residence,\n                           use_direct_label = TRUE,\n                           use_group_by = FALSE,\n                           unhighlighted_params = list(linewidth = 0.5)\n                           ) +\n  geom_hline(yintercept = 0.5, linewidth = 1, linetype = 2, col = \"grey40\") +\n  scale_y_continuous(labels = scales::percent) +\n  scale_color_manual(name = \"\",\n                     values = thematic::okabe_ito(4)) +\n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\",\n        legend.key = element_blank(),\n        axis.text.y.right = element_text(size = 10, \n                                         family = \"Karla\", \n                                         face = \"bold\")) +\n    labs(x = NULL, \n         y = NULL, \n         title = \"Medicare Advantage Enrollees (%)\",\n         caption = \"Source: Centers for Medicare & Medicaid Services. Plot by @aabrucehimni.\")\n```\n\n::: {.cell-output-display}\n![Linear Regression](monthly_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n<br>\n\n\n::: {.cell fig.showtext='true'}\n\n:::\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\norig_ma <- enrollment |> \n  dplyr::select(year, \n                \"Original\" = original, \n                \"Advantage\" = ma_other) |> \n  tidyr::pivot_longer(!year, \n                      names_to = \"type\", \n                      values_to = \"n\") |> \n  dplyr::mutate(year = as_date(parsedate::parse_date(year)))\n\norig_ma_prop <- enrollment |> \n  dplyr::select(year, \n                \"Original\" = original_pct, \n                \"Advantage\" = ma_other_pct) |> \n  tidyr::pivot_longer(!year, \n                      names_to = \"type\", \n                      values_to = \"pct\")\n\nggplot(orig_ma, aes(year, n, \n                    fill = type, \n                    label = type)) +\n  geom_stream(type = \"ridge\") +\n  geom_stream_label(size = 4, type = \"ridge\") + \n  scale_x_date(date_breaks = \"1 year\",\n               date_labels = \"%y\", \n               expand = c(0, 0)) +\n  ggthemes::theme_fivethirtyeight() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](monthly_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "monthly_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}